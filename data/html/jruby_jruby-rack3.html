<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>jruby_jruby-rack3</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<pre><code>&lt;filter-mapping&gt;
  &lt;filter-name&gt;RackFilter&lt;/filter-name&gt;
  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;

&lt;listener&gt;
  &lt;listener-class&gt;org.jruby.rack.RackServletContextListener&lt;/listener-class&gt;
&lt;/listener&gt;</code></pre>
<p>If you don’t have a <em>config.ru</em> or don’t want to include it in your web app, you can embed it directly in the <em>web.xml</em> as follows (using Sinatra as an example):</p>
<pre><code>&lt;context-param&gt;
  &lt;param-name&gt;rackup&lt;/param-name&gt;
  &lt;param-value&gt;
    require &#39;rubygems&#39;
    gem &#39;sinatra&#39;, &#39;~&amp;gt; 1.3&#39;
    require &#39;./lib/app&#39;
    set :run, false
    set :environment, :production
    run Sinatra::Application
  &lt;/param-value&gt;
&lt;/context-param&gt;</code></pre>
<p>Be sure to escape angle-brackets for XML !</p>
<h2 id="servlet-filter">Servlet Filter</h2>
<p>JRuby-Rack’s main mode of operation is as a filter. This allows requests for static content to pass through and be served by the application server. Dynamic requests only happen for URLs that don’t have a corresponding file, much like many Ruby/Rack applications expect. The (default) filter we recommend using is <code>org.jruby.rack.RackFilter</code>, the filter supports the following (optional) init-params:</p>
<ul>
<li><strong>responseNotHandledStatuses</strong> which statuses (when a filter chain returns) should be considered that the response has not been handled (default value: “403,404,405”) and should be dispatched as a Rack application</li>
<li><strong>resetUnhandledResponse</strong> whether an unhandled response from the filter chain gets reset (accepts values “true”, “false” and “buffer” to reset the buffer only), by default “true”</li>
<li><strong>addsHtmlToPathInfo</strong> controls whether the .html suffix is added to the URI when checking if the request is for a static page</li>
<li><strong>verifiesHtmlResource</strong> used with the previous parameter to make sure the requested static resource exists before adding the .html request URI suffix</li>
</ul>
<p>The application can also be configured to dispatch through a servlet instead of a filter, the servlet class name is <code>org.jruby.rack.RackServlet</code>.</p>
</body>
</html>
