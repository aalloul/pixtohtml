<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>dpw_pachuco1</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="introduction">Introduction</h1>
<p>Pachuco is a self-hosting compiler for a dialect of the Lisp programming language. It generates assembly code directly, rather than compiling to another high-level language or virtual machine. It targets x86 (32- and 64-bit), ARM and MIPS. The goal of the compiler is to be simple and fast: On my 2013-era x86 laptop, it compiles itself in under 0.2s.</p>
<p>The system is about 10000 lines of code, including the compiler, runtime, garbage collector, and interpreter (used in the macro system). The whole system is written in the Pachuco language, except for a minimal amount of C and Common Lisp code for bootstrapping. The implementation remains very spartan in comparison to production compilers (e.g.Â its error reporting is almost non-existent).</p>
<p>The Pachuco language is briefly described in the LANGUAGE file. It is modest in comparison to Common Lisp and Scheme. Like Scheme, the language features a small core, lexically-scoped variables, and supports proper tail recursion. But the macro system and the library functions in the runtime are influenced more by Common Lisp.</p>
<p>Like a C compiler, the Pachuco compiler produces stand-alone executables. Unlike traditional Lisps, it is not integrated into a read-eval-print loop, although the system does include a simple interpreter-based REPL.</p>
<h1 id="getting-started">Getting Started</h1>
<p>Pachuco currently builds and runs under Linux. It requires basic development tools to be installed, such as gcc, binutils, and make. It also uses the sbcl implementation of Common Lisp to bootstrap itself. This is available as the sbcl package on Debian, Ubuntu and Fedora, or see .</p>
<p>Running <code>make all</code> bootstraps the compiler and runs some tests. The resulting compiler executable is in <code>build/stage2</code>, but it is normally invoked via the shell script <code>scripts/compile</code>. Among other things, this script includes the standard runtime files into the compilation, and invokes gcc to assemble the compiler output into a working executable.</p>
<p>There is a simple example program to generate the Fibonacci sequence in <code>examples/fib.pco</code>. Compile it with:</p>
<pre><code>$ scripts/compile examples/fib.pco -o build/fib</code></pre>
<p>(The <code>-o</code> option specifies the name of the destination executable.)</p>
<p>The result is a stand-alone executable that you can run from the</p>
</body>
</html>
