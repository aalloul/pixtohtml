<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>rsim_oracle-enhanced10</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p>See Oracle Text documentation for syntax that you can use in CONTAINS function in SELECT WHERE clause.</p>
<p>You can also specify some dummy main column name when creating multiple column index as well as specify to update index automatically after each commit (as otherwise you need to synchronize index manually or schedule periodic update):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode ruby"><code class="sourceCode ruby"><a class="sourceLine" id="cb1-1" data-line-number="1">add_context_index <span class="st">:posts</span>, [<span class="st">:title</span>, <span class="st">:body</span>], <span class="st">:index_column</span> =&gt; <span class="st">:all_text</span>, <span class="st">:sync</span> =&gt; <span class="st">&#39;ON COMMIT&#39;</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="dt">Post</span>.contains(<span class="st">:all_text</span>, <span class="st">&#39;word&#39;</span>)</a></code></pre></div>
<p>Or you can specify that index should be updated when specified columns are updated (e.g. in ActiveRecord you can specify to trigger index update when created_at or updated_at columns are updated). Otherwise index is updated only when main index column is updated.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode ruby"><code class="sourceCode ruby"><a class="sourceLine" id="cb2-1" data-line-number="1">add_context_index <span class="st">:posts</span>, [<span class="st">:title</span>, <span class="st">:body</span>], <span class="st">:index_column</span> =&gt; <span class="st">:all_text</span>,</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  <span class="st">:sync</span> =&gt; <span class="st">&#39;ON COMMIT&#39;</span>, <span class="st">:index_column_trigger_on</span> =&gt; [<span class="st">:created_at</span>, <span class="st">:updated_at</span>]</a></code></pre></div>
<p>And you can even create index on multiple tables by providing SELECT statements which should be used to fetch necessary columns from related tables:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode ruby"><code class="sourceCode ruby"><a class="sourceLine" id="cb3-1" data-line-number="1">add_context_index <span class="st">:posts</span>,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  [<span class="st">:title</span>, <span class="st">:body</span>,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="co"># specify aliases always with AS keyword</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  <span class="st">&quot;SELECT comments.author AS comment_author, comments.body AS comment_body FROM comments WHERE comments.post_id = :id&quot;</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  ],</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  <span class="st">:name</span> =&gt; <span class="st">&#39;post_and_comments_index&#39;</span>,</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  <span class="st">:index_column</span> =&gt; <span class="st">:all_text</span>,</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  <span class="st">:index_column_trigger_on</span> =&gt; [<span class="st">:updated_at</span>, <span class="st">:comments_count</span>],</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  <span class="st">:sync</span> =&gt; <span class="st">&#39;ON COMMIT&#39;</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co"># search in any table columns</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="dt">Post</span>.contains(<span class="st">:all_text</span>, <span class="st">&#39;word&#39;</span>)</a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co"># search in specified column</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="dt">Post</span>.contains(<span class="st">:all_text</span>, <span class="st">&quot;aaa within title&quot;</span>)</a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="dt">Post</span>.contains(<span class="st">:all_text</span>, <span class="st">&quot;bbb within comment_author&quot;</span>)</a></code></pre></div>
<p>Please note that <code>index_column</code> must be a real column in your database and it’s value will be overridden every time your <code>index_column_trigger_on</code> columns are changed. So, <em>do not use columns with real data as <code>index_column</code></em>.</p>
<p>Index column can be created as:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode ruby"><code class="sourceCode ruby"><a class="sourceLine" id="cb4-1" data-line-number="1">add_column <span class="st">:posts</span>, <span class="st">:all_text</span>, <span class="st">:string</span>, <span class="st">limit: </span><span class="dv">2</span>, <span class="st">comment: &#39;Service column for context search index&#39;</span></a></code></pre></div>
<h3 id="oracle-virtual-columns-support">Oracle virtual columns support</h3>
<p>Since version R11G1 Oracle database allows adding computed to the table. They can be used as normal fields in the queries, in the foreign key contstraints and to partitioning data.</p>
</body>
</html>
