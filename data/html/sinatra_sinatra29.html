<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>sinatra_sinatra29</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p>end</p>
<p>get ‘/:value’ do session[‘value’] = params[‘value’] end ```</p>
<h4 id="session-secret-security">Session Secret Security</h4>
<p>To improve security, the session data in the cookie is signed with a session secret using <code>HMAC-SHA1</code>. This session secret should optimally be a cryptographically secure random value of an appropriate length which for <code>HMAC-SHA1</code> is greater than or equal to 64 bytes (512 bits, 128 hex characters). You would be advised not to use a secret that is less than 32 bytes of randomness (256 bits, 64 hex characters). It is therefore <strong>very important</strong> that you don’t just make the secret up, but instead use a secure random number generator to create it. Humans are extremely bad at generating random values.</p>
<p>By default, a 32 byte secure random session secret is generated for you by Sinatra, but it will change with every restart of your application. If you have multiple instances of your application, and you let Sinatra generate the key, each instance would then have a different session key which is probably not what you want.</p>
<p>For better security and usability it’s that you generate a secure random secret and store it in an environment variable on each host running your application so that all of your application instances will share the same secret. You should periodically rotate this session secret to a new value. Here are some examples of how you might create a 64 byte secret and set it:</p>
<p><strong>Session Secret Generation</strong></p>
<pre class="text"><code>$ ruby -e &quot;require &#39;securerandom&#39;; puts SecureRandom.hex(64)&quot;
99ae8af...snip...ec0f262ac</code></pre>
<p><strong>Session Secret Generation (Bonus Points)</strong></p>
<p>Use the to prefer use of system RNG facilities to generate random values instead of userspace <code>OpenSSL</code> which MRI Ruby currently defaults to:</p>
<p>```text $ gem install sysrandom Building native extensions. This could take a while… Successfully installed sysrandom-1.x 1 gem installed</p>
</body>
</html>
