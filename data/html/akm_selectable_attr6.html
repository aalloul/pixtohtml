<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>akm_selectable_attr6</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<pre><code>irb&gt; enum.key_by_id(&#39;04&#39;)
=&gt; :svn
irb&gt; enum.id_by_key(:svn)
=&gt; &quot;04&quot;
irb&gt; enum.name_by_id(&#39;04&#39;)
=&gt; &quot;Subversion&quot;
irb&gt; enum.name_by_key(:svn)
=&gt; &quot;Subversion&quot;
irb&gt; enum.to_hash_array
=&gt; [
  {:key=&gt;:http, :port=&gt;80, :name=&gt;&quot;HTTP&quot;, :id=&gt;&quot;01&quot;}, 
  {:key=&gt;:https, :port=&gt;443, :name=&gt;&quot;HTTPS&quot;, :id=&gt;&quot;02&quot;}, 
  {:key=&gt;:ssh, :port=&gt;22, :name=&gt;&quot;SSH&quot;, :id=&gt;&quot;03&quot;}, 
  {:key=&gt;:svn, :port=&gt;3690, :name=&gt;&quot;Subversion&quot;, :id=&gt;&quot;04&quot;}
]</code></pre>
<p>id, key以外でエントリを特定したい場合はfindメソッドが使えます。 irb&gt; enum.find(:port =&gt; 22) =&gt; #&lt;SelectableAttr::Enum::Entry:1352a54 <span class="citation" data-cites="id">@id</span>=“03”, <span class="citation" data-cites="key">@key</span>=:ssh, <span class="citation" data-cites="name">@name</span>=“SSH”, <span class="citation" data-cites="options">@options</span>={:port=&gt;22}</p>
<p>findメソッドにはブロックを渡すこともできます。 irb&gt; enum.find{|entry| entry[:port] &gt; 1024} =&gt; #&lt;SelectableAttr::Enum::Entry:1352a04 <span class="citation" data-cites="id">@id</span>=“04”, <span class="citation" data-cites="key">@key</span>=:svn, <span class="citation" data-cites="name">@name</span>=“Subversion”, <span class="citation" data-cites="options">@options</span>={:port=&gt;3690}</p>
<h3 id="entryへのメソッド定義">Entryへのメソッド定義</h3>
<p>entryメソッドにブロックを渡すとエントリのオブジェクトにメソッドを定義することが可能です。</p>
<pre><code>require &#39;rubygems&#39;
require &#39;selectable_attr&#39;

class Site
  include ::SelectableAttr::Base

  selectable_attr :protocol do
    entry &#39;01&#39;, :http , &#39;HTTP&#39;, :port =&gt; 80 do
      def accept?(model)
        # httpで指定された場合はhttpsも可、という仕様
        model.url =~ /^http[s]{0,1}\:\/\//
      end
    end

    entry &#39;02&#39;, :https, &#39;HTTPS&#39;, :port =&gt; 443 do
      def accept?(model)
        model.url =~ /^https\:\/\//
      end
    end

    entry &#39;03&#39;, :ssh  , &#39;SSH&#39;, :port =&gt; 22 do
      def accept?(model)</code></pre>
</body>
</html>
