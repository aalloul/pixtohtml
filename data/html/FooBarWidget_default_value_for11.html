<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>FooBarWidget_default_value_for11</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="controller">Controller</h1>
<p>def create <span class="citation" data-cites="user">@user</span> = User.new(params[:user]) email_report_to_admin(“#{<span class="citation" data-cites="user.username">@user.username</span>} with UUID #{<span class="citation" data-cites="user.uuid">@user.uuid</span>} created.”) <span class="citation" data-cites="user.save">@user.save</span>! end</p>
<h1 id="model">Model</h1>
<p>class User &lt; ActiveRecord::Base before_save :generate_uuid_if_necessary</p>
<p>def uuid value = read_attribute(‘uuid’) if !value value = generate_uuid write_attribute(‘uuid’, value) end value end</p>
<p># We need to override this too, otherwise User.new.attributes won’t return # a default UUID value. I’ve never tested with User.create() so maybe we # need to override even more things. def attributes uuid super end</p>
<p>private def generate_uuid_if_necessary uuid # Reader method automatically generates UUID if it doesn’t exist end end ```</p>
<p>That’s an awful lot of code. Using <code>default_value_for</code> is easier, don’t you think?</p>
<h3 id="what-about-other-plugins">What about other plugins?</h3>
<p>I’ve only been able to find 2 similar plugins:</p>
<ul>
<li><p>Default Value: http://agilewebdevelopment.com/plugins/default_value</p></li>
<li><p>ActiveRecord Defaults: http://agilewebdevelopment.com/plugins/activerecord_defaults</p></li>
</ul>
<p>‘Default Value’ appears to be unmaintained; its SVN link is broken. This leaves only ‘ActiveRecord Defaults’. However, it is semantically dubious, which leaves it wide open for corner cases. For example, it is not clearly specified what ActiveRecord Defaults will do when attributes are protected by +attr_protected+ or +attr_accessible+. It is also not clearly specified what one is supposed to do if one needs a custom +initialize+ method in the model.</p>
<p>I’ve taken my time to thoroughly document default_value_for’s behavior.</p>
<h2 id="credits">Credits</h2>
</body>
</html>
