<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>akm_selectable_attr5</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<pre><code> {:key=&gt;:http, :port=&gt;80, :name=&gt;&quot;HTTP&quot;, :id=&gt;&quot;01&quot;}, 
 {:key=&gt;:https, :port=&gt;443, :name=&gt;&quot;HTTPS&quot;, :id=&gt;&quot;02&quot;}, 
 {:key=&gt;:ssh, :port=&gt;22, :name=&gt;&quot;SSH&quot;, :id=&gt;&quot;03&quot;}, 
 {:key=&gt;:svn, :port=&gt;3690, :name=&gt;&quot;Subversion&quot;, :id=&gt;&quot;04&quot;} 
]</code></pre>
<h3 id="enum">Enum</h3>
<p>あまり表にでてきませんが、エントリをまとめる役割のオブジェクトがEnumです。 これはクラスメソッドxxx_enumで取得することができます。</p>
<pre><code>irb&gt; enum = Site.protocol_enum</code></pre>
<p>Enumには以下のようなメソッドが用意されています。 irb&gt; enum.entries irb&gt; enum.entries.map{|entry| entry[:port]} =&gt; [80, 443, 22, 3690]</p>
<p>EnumはEnumerableをincludeしているため、以下のように記述することも可能です。 irb&gt; enum.map{|entry| entry[:port]} =&gt; [80, 443, 22, 3690]</p>
<pre><code>irb&gt;  enum.entry_by_id(&quot;03&quot;)
=&gt; #&lt;SelectableAttr::Enum::Entry:1352a54 @id=&quot;03&quot;, @key=:ssh, @name=&quot;SSH&quot;, @options={:port=&gt;22}
irb&gt;  enum.entry_by_key(:ssh)
=&gt; #&lt;SelectableAttr::Enum::Entry:1352a54 @id=&quot;03&quot;, @key=:ssh, @name=&quot;SSH&quot;, @options={:port=&gt;22}
irb&gt;  enum.entry_by_id_or_key(:ssh)
=&gt; #&lt;SelectableAttr::Enum::Entry:1352a54 @id=&quot;03&quot;, @key=:ssh, @name=&quot;SSH&quot;, @options={:port=&gt;22}
irb&gt;  enum.entry_by_id_or_key(&#39;03&#39;)
=&gt; #&lt;SelectableAttr::Enum::Entry:1352a54 @id=&quot;03&quot;, @key=:ssh, @name=&quot;SSH&quot;, @options={:port=&gt;22}
irb&gt;  enum.entry_by_hash(:port =&gt; 22)
=&gt; #&lt;SelectableAttr::Enum::Entry:1352a54 @id=&quot;03&quot;, @key=:ssh, @name=&quot;SSH&quot;, @options={:port=&gt;22}</code></pre>
<p>また、これらのメソッドが面倒と感じるようであれば、以下のような簡単なアクセスも可能です。 irb&gt; enum[‘03’] =&gt; #&lt;SelectableAttr::Enum::Entry:1352a54 <span class="citation" data-cites="id">@id</span>=“03”, <span class="citation" data-cites="key">@key</span>=:ssh, <span class="citation" data-cites="name">@name</span>=“SSH”, <span class="citation" data-cites="options">@options</span>={:port=&gt;22} irb&gt; enum[:ssh] =&gt; #&lt;SelectableAttr::Enum::Entry:1352a54 <span class="citation" data-cites="id">@id</span>=“03”, <span class="citation" data-cites="key">@key</span>=:ssh, <span class="citation" data-cites="name">@name</span>=“SSH”, <span class="citation" data-cites="options">@options</span>={:port=&gt;22} irb&gt; enum[:port =&gt; 22] =&gt; #&lt;SelectableAttr::Enum::Entry:1352a54 <span class="citation" data-cites="id">@id</span>=“03”, <span class="citation" data-cites="key">@key</span>=:ssh, <span class="citation" data-cites="name">@name</span>=“SSH”, <span class="citation" data-cites="options">@options</span>={:port=&gt;22}</p>
<p>またクラスメソッドで紹介したようなxxx_ids, xxx_keys, xxx_namesや、xxx_key_by_idなどのメソッドも用意されています。 irb&gt; enum.ids =&gt; [“01”, “02”, “03”, “04”] irb&gt; enum.keys =&gt; [:http, :https, :ssh, :svn] irb&gt; enum.names =&gt; [“HTTP”, “HTTPS”, “SSH”, “Subversion”] irb&gt; enum.options =&gt; [[“HTTP”, “01”], [“HTTPS”, “02”], [“SSH”, “03”], [“Subversion”, “04”]]</p>
</body>
</html>
