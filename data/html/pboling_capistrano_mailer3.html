<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>pboling_capistrano_mailer3</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<pre><code>####################################
# Capistrano Plugins go here
require &#39;capistrano/mailer&#39;
#configure capistrano_mailer:
# The configuration file can go anywhere, but in past versions of the gem it was required to be in the config/ dir.
require &#39;config/cap_mailer_settings&#39;
####################################</code></pre>
<ol start="3" type="1">
<li><p>Configure Caistrano Mailer in the settings file required in step 2:</p>
<p># If installed as a plugin might need the require here as well</p>
<p>ActionMailer::Base.delivery_method = :smtp # or :sendmail, or whatever ActionMailer::Base.smtp_settings = { # if using :smtp :address =&gt; “mail.example.com”, :port =&gt; 25, :domain =&gt; ‘default.com’, :perform_deliveries =&gt; true, :user_name =&gt; “releases@example.com”, :password =&gt; “mypassword”, :authentication =&gt; :login } ActionMailer::Base.default_charset = “utf-8”# or “latin1” or whatever you are using</p>
<p>CapMailer.configure do |config| config[:recipient_addresses] = [“dev1@example.com”] # NOTE: THERE IS A BUG IN RAILS 2.3.3 which forces us to NOT use anything but a simple email address string for the sender address. # https://rails.lighthouseapp.com/projects/8994/tickets/2340 # Therefore %(“Capistrano Deployment” <a href="mailto:releases@example.com">releases@example.com</a>) style addresses may not work in Rails 2.3.3 config[:sender_address] = “deployment@example.com” config[:subject_prepend] = “[EMPTY-CAP-DEPLOY]” config[:site_name] = “Empty Example.com App” end</p></li>
<li><p>Add these two tasks to your deploy.rb:</p>
<p>namespace :show do desc “Show some internal Cap-Fu: What’s mah NAYM?!?” task :me do set :task_name, task_call_frames.first.task.fully_qualified_name #puts “Running #{task_name} task” end end</p>
<p>namespace :deploy do …</p>
<p>desc “Send email notification of deployment (only send variables you want to be in the email)” task :notify, :roles =&gt; :app do show.me # this sets the task_name variable mailer.send_notification_email(self)</p></li>
</ol>
</body>
</html>
