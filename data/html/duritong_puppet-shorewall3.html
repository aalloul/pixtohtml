<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>duritong_puppet-shorewall3</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p>Example usage follows.</p>
<p>Torify any outgoing TCP traffic originating from user bob or alice and aimed at 6.6.6.6 or 7.7.7.7:</p>
<pre><code>shorewall::rules::torify {
  &#39;torify-some-bits&#39;:
    users        =&gt; [ &#39;bob&#39;, &#39;alice&#39; ],
    destinations =&gt; [ &#39;6.6.6.6&#39;, &#39;7.7.7.7&#39; ];
}</code></pre>
<p>Torify any outgoing TCP traffic to 8.8.8.8:</p>
<pre><code>shorewall::rules::torify {
  &#39;torify-to-this-host&#39;:
    destinations  =&gt; [ &#39;8.8.8.8&#39; ];
}</code></pre>
<p>When no destination nor user is provided any outgoing TCP traffic (see restrictions bellow) is torified. In that case the user running the Tor client ($tor_user) is whitelisted; this variable defaults to “debian-tor” on Debian systems and to “tor” on others. if this does not suit your configuration you need to set the $tor_user variable before including the main shorewall class.</p>
<p>When no destination is provided traffic directed to RFC1918 addresses is by default allowed and (obviously) not torified. This behaviour can be changed by setting the allow_rfc1918 parameter to false.</p>
<p>Torify any outgoing TCP traffic but connections to RFC1918 addresses:</p>
<pre><code>shorewall::rules::torify {
  &#39;torify-everything-but-lan&#39;:
}</code></pre>
<p>Torify any outgoing TCP traffic:</p>
<pre><code>shorewall::rules::torify {
  &#39;torify-everything:
    allow_rfc1918 =&gt; false;
}</code></pre>
<p>In some cases (e.g. when providing no specific destination nor user and denying access to RFC1918 addresses) UDP DNS requests may be rejected. This is intentional: it does not make sense leaking -via DNS requests- network activity that would otherwise be torified. In that case you probably want to read proper documentation about such matters, enable the Tor DNS resolver and redirect DNS requests through it.</p>
</body>
</html>
