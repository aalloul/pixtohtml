<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>kragen_minimilter1</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="minimilter">minimilter</h1>
<p><link rel="stylesheet" href="../style.css" /></p>
<p>This is in HTML at <a href="http://canonical.org/~kragen/sw/minimilter.html" class="uri">http://canonical.org/~kragen/sw/minimilter.html</a>.</p>
<p>This is a very simple implementation in pure Python, including a sample milter. I’m using this to filter spam under Postfix on panacea.canonical.org, which is Bad and Wrong for several reasons:</p>
<ol type="1">
<li>I could do the same thing more easily with sender and recipient restrictions.</li>
<li>Postfix’s “policy service” interface is about a thousand times saner than the Milter interface, and performs the same job. Writing to the Milter interface does mean that you could, in theory, use this with other MTAs that support milters.</li>
</ol>
<h2 id="about-milters">About Milters</h2>
<p>Milters are a way to reject or modify mail before it goes into the mail queue. I care about this because it lets me bounce spam to its real sender, not the forged from-address on the mail, so I don’t become part of the backscatter problem.</p>
<p>MTAs that support milters include , , and .</p>
<p>Sendmail includes <code>libmilter</code>, which lets you write milters in C.</p>
<p>I’m using the sample milter to bounce unauthorized mail to some Mailman mailing lists, on a machine with Postfix, so that our server doesn’t generate backscatter. I’m probably going to switch away from it shortly because it turns out Postfix has a built-in feature that does more or less the same thing.</p>
<h2 id="about-backscatter">About Backscatter</h2>
<p>Backscatter is when spam sent from a forged <code>From</code> address gets bounced back to that address, effectively turning the spam’s first recipient into an inadvertent spam source. To avoid creating backscatter, don’t bounce mail after accepting it; instead, refuse the mail at SMTP-time.</p>
<p>Getting it</p>
</body>
</html>
