<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>jaimeiniesta_metainspector8</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="normalization-will-add-a-default-scheme-and-a-trailing-slash">Normalization will add a default scheme and a trailing slash…</h1>
<p>page = MetaInspector.new(‘sitevalidator.com’) page.url # http://sitevalidator.com/</p>
<h1 id="and-it-will-also-convert-international-characters">…and it will also convert international characters</h1>
<p>page = MetaInspector.new(‘http://www.詹姆斯.com’) page.url # http://www.xn–8ws00zhy3a.com/ ```</p>
<p>While this is generally useful, it can be .</p>
<p>You can disable URL normalization by passing the <code>normalize_url: false</code> option.</p>
<h3 id="image-downloading">Image downloading</h3>
<p>When you ask for the largest image on the page with <code>page.images.largest</code>, it will be determined by its height and width attributes on the HTML markup, and also by downloading a small portion of each image using the gem. This is really fast as it doesn’t download the entire images, normally just the headers of the image files.</p>
<p>If you want to disable this, you can specify it like this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode ruby"><code class="sourceCode ruby"><a class="sourceLine" id="cb1-1" data-line-number="1">page = <span class="dt">MetaInspector</span>.new(<span class="st">&#39;http://example.com&#39;</span>, <span class="st">download_images: </span><span class="dv">false</span>)</a></code></pre></div>
<h3 id="caching-responses">Caching responses</h3>
<p>MetaInspector can be configured to use to cache page responses. For that you should pass the <code>faraday_http_cache</code> option with at least the <code>:store</code> key, for example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode ruby"><code class="sourceCode ruby"><a class="sourceLine" id="cb2-1" data-line-number="1">cache = <span class="dt">ActiveSupport</span>::<span class="dt">Cache</span>.lookup_store(<span class="st">:file_store</span>, <span class="st">&#39;/tmp/cache&#39;</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">page = <span class="dt">MetaInspector</span>.new(<span class="st">&#39;http://example.com&#39;</span>, <span class="st">faraday_http_cache: </span>{ <span class="st">store: </span>cache })</a></code></pre></div>
<h2 id="exception-handling">Exception Handling</h2>
<p>Web page scraping is tricky, you can expect to find different exceptions during the request of the page or the parsing of its contents. MetaInspector will encapsulate these exceptions on these main errors:</p>
<ul>
<li><code>MetaInspector::TimeoutError</code>. When fetching a web page has taken too long.</li>
<li><code>MetaInspector::RequestError</code>. When there has been an error on the request phase. Examples: page not found, SSL failure, invalid URI.</li>
<li><code>MetaInspector::ParserError</code>. When there has been an error parsing the contents of the page. Example: trying to parse an image file.</li>
</ul>
<h2 id="examples">Examples</h2>
<p>You can find some sample scripts on the <code>examples</code> folder, including a basic scraping and a spider that will follow external links using a queue. What follows is an example of use from irb:</p>
<p>```ruby $ irb &gt;&gt; require ‘metainspector’ =&gt; true</p>
<blockquote>
<blockquote>
<p>page = MetaInspector.new(‘http://sitevalidator.com’)</p>
</blockquote>
</blockquote>
</body>
</html>
