<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>akm_selectable_attr_rails3</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p>この場合、&lt;input type=“checkbox” …/&gt;<label for="xxx">… という風に続けて出力されるので、改行などを出力したい場合は 引数を一つ取るブロックを渡して以下のように記述します。</p>
<pre><code>&lt;% form_for(:person) do |f| %&gt;
  &lt;% f.check_box_group :gender do |b| %&gt;
    &lt;% b.each do %&gt;
      &lt;%= b.check_box %&gt;
      &lt;%= b.label %&gt;
      &lt;br/&gt;
    &lt;% end %&gt;
  &lt;% end %&gt;
&lt;% end %&gt;</code></pre>
<p>f.check_box_groupを呼び出しているERBのタグが、&lt;%= %&gt;から&lt;% %&gt;に変わっていることにご注意ください。</p>
<h2 id="dbからのエントリの更新追加">DBからのエントリの更新／追加</h2>
<p>各エントリの名称を実行時に変更したり、項目を追加することが可能です。</p>
<pre><code>class RoomPlan &lt; ActiveRecord::Base
  include ::SelectableAttr::Base
  
  selectable_attr :room_type do
    update_by &quot;select room_type, name from room_types&quot;
    entry &#39;01&#39;, :single, &#39;シングル&#39;
    entry &#39;02&#39;, :twin, &#39;ツイン&#39;
    entry &#39;03&#39;, :double, &#39;ダブル&#39;
    entry &#39;04&#39;, :triple, &#39;トリプル&#39;
  end
end</code></pre>
<p>というモデルと</p>
<pre><code> create_table &quot;room_types&quot; do |t|
   t.string   &quot;room_type&quot;, :limit =&gt; 2
   t.string   &quot;name&quot;, :limit =&gt; 20
 end</code></pre>
<p>というマイグレーションで作成されるテーブルがあったとします。</p>
<h3 id="エントリの追加">エントリの追加</h3>
<p>room_typeが“05”、nameが“４ベッド”というレコードがINSERTされた後、 RoomPlan#room_type_optionsなどのselectable_attrが提供するメソッドで 各エントリへアクセスすると、update_byで指定されたSELECT文が実行され、 エントリとしては、 entry ‘05’, :entry_05, ‘４ベッド’ が定義されている状態と同じようになります。</p>
<p>このようにコードで定義されていないエントリは、DELETEされると、エントリもなくなります。</p>
</body>
</html>
