<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>svetlyak40wt_django-pingback3</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<pre><code>from django.db.models import signals
from pingback.client import ping_external_links, ping_directories
from blog.models import Post

signals.post_save.connect(
        ping_external_links(content_attr = &#39;html&#39;,
                            url_attr = &#39;get_absolute_url&#39;),
        sender = Post, weak = False)

signals.post_save.connect(
        ping_directories(content_attr = &#39;html&#39;,
                         url_attr = &#39;get_absolute_url&#39;),
        sender = Post, weak = False)</code></pre>
<p>Please note, that in the <code>content_attr</code> you must give either attribute or method name, which returns HTML content of the object.</p>
<p>If you don’t have such attribute or method, for example if you apply markdown filter in the template, then <code>content_func</code> argument can be used instead of the <code>content_attr</code>.</p>
<p><code>content_func</code> must return HTML, and must accepts an instance as a single argument.</p>
<p>Pay attention to the <code>weak = False</code> argument. If case of omitting django’s event dispatcher will remove your signal.</p>
<h2 id="template-tags">Template tags</h2>
<p>To show pingbacks on your page, you can use code like this:</p>
<pre><code>{% load pingback_tags %}
{% get_pingback_list for object as pingbacks %}
{% if pingbacks %}
    &lt;h1&gt;Pingbacks&lt;/h1&gt;
    {% for pingback in pingbacks %}
        &lt;div class=&quot;b-pingback&quot;&gt;
            &lt;p class=&quot;b-meta&quot;&gt;
                &lt;a name=&quot;pingback-{{ pingback.id }}&quot; href=&quot;{{ object.get_absolute_url }}#pingback-{{ pingback.id }}&quot; class=&quot;b-permlink&quot;&gt;permalink&lt;/a&gt;
                {{ pingback.date }}, pingback from {{ pingback.url|urlizetrunc:40 }}:
            &lt;/p&gt;

            &lt;p&gt;{{ pingback.content }}&lt;/p&gt;
        &lt;/div&gt;
    {% endfor %}
{% endif %}</code></pre>
<p>Also you can use <code>{% get_pingback_count for object as cnt %}</code>, to save</p>
</body>
</html>
