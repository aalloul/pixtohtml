<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>gensym_rewrite_rails1</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="the-rewriterails-plug-in">The RewriteRails Plug-In</h1>
<p>The . All of the power and convenience, none of the compatibility woes and head-aches.</p>
<h2 id="should-you-care">Should You Care?</h2>
<p>If you’re already using gems like <code>Object#andand</code> or <code>String#to_proc</code>, RewriteRails is absolutely for you. You can continue to do what you’re already doing, but your rails code will be faster and you will never have to worry about some gems conflicting with each other and with ActiveSupport as it grows.</p>
<p>If you have considered using <code>Object#andand</code> or <code>String#to_proc</code>, but hesitated because you are worried about encumbering classes like <code>Object</code> and <code>String</code> with even more methods, RewriteRails is for you. You get to use these powerful constructs without monkey-patching. You read that right. <strong>RewriteRails is a No-Monkey-Patching Zone</strong>.</p>
<p><em>If you want the power and convenience without the head-aches. RewriteRails is for you.</em></p>
<h2 id="q-a">Q &amp; A</h2>
<p><strong>How does it work?</strong></p>
<p>Install the <code>RewriteRails</code> plugin in your Rails project and the gems ParseTree and Ruby2Ruby (in your system or frozen into your project). You can write ruby files as usual (e.g. <code>foo_bar.rb</code>), and things will work as usual. You can also have <code>RewriteRails</code> rewrite Ruby files for you. Any file with the suffix <code>.rr</code> will be “rewritten.”</p>
<p>RewriteRails takes your <code>.rr</code> files and scans them with <em>rewriters</em>. Each rewriter looks for a certain kind of Ruby code and rewrites it into another kind of Ruby code. This produces the same effect as a C Preprocessor, a C++ template, or a Lisp Macro.</p>
<p>Currently, the rewriters are things that could be implemented by opening core classes and monkey-patching, but implementing them as rewriters means that you have higher performance and .</p>
<p>By default, the rewritten files are stored in the <code>rewritten</code> directory of your project. So if you create a file called <code>foo.rr</code> in <code>lib</code> directory, you will find a file called <code>foo.rb</code> in <code>rewritten/lib</code>. This means you can always see what RewriteRails is doing, and if you want to stop using it you have 100% working Ruby files.</p>
<p>RewriteRails also tells Rails to look in the <code>rewritten</code> folder for your code, so you don’t have to move anything around, it’s as if Rails is reading your <code>.rr</code> files directly.</p>
<p><strong>So is a <code>.rr</code> file something like an erb or haml template?</strong></p>
<p>Yes. And also No. Yes, it is like a template in that it is turned into a <code>.rb</code> file that Rails executes. But no in that you won’t find a bunch of special directives or any other trappings of a “template language.” <code>.rr</code> files are Ruby files, they look like they use a bunch of monkey-patched extensions, but RewriteRails rewrites them so that they only use Standard Ruby.</p>
<p>If you would like a metaphor, imagine that you embrace syntactic abstractions like <code>#andand</code>, but you have a colleague who dislikes monkey-patching intensely, so much so that every time you write some code like:</p>
<pre><code>Product.find(:first, ...).andand.update_attribute(:on_sale, true)</code></pre>
<p>Your colleague “fixes” it by rewriting it to:</p>
<pre><code>(first_product = Product.find(:first, ...) and first_product.update_attribute(:on_sale, true))</code></pre>
<p>The good news is that while your colleague’s rewriting destroys what you originally wrote, RewriteRails leaves your <code>.rr</code> files just the way it found them. So with RewriteRails, both you and your colleague can get along just fine.</p>
<p><strong>How do I know what will be rewritten?</strong></p>
<p>Consult . More will be added as I write them or port them from the old rewrite gem.</p>
<p><strong>How can I see what is rewritten?</strong></p>
<p>After you write a <code>.rr</code> file, you can run your code in the normal way: <code>script/console</code>, <code>script/server</code>, or best of all <code>rake test</code> :-)</p>
</body>
</html>
