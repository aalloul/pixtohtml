<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>harvesthq_pharm2</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<ul>
<li>cap deploy:setup</li>
<li>cap deploy:migrations o If this doesn’t work for you (new changes aren’t getting deployed), change: set :deploy_via, :remote_cache In deploy.rb to: set :deploy_via, :copy It’ll be slow, but at least it should work.</li>
<li>Visit http://yourdomain.tld/admin to add a picture. Then http://yourdomain.tld will work!</li>
</ul>
<p>TODO: Instructions for remote cache deploy working TODO: Can we make a simple drag and drop FTP deploy?</p>
<h3 id="sample-capistrano-deploy.rb">Sample capistrano <code>deploy.rb</code></h3>
<pre><code>default_run_options[:pty] = true  # Force password prompt from git

set :user, &quot;bjhess&quot;
set :domain, &quot;something.dreamhost.com&quot;
set :application, &quot;snapped.bjhess.com&quot;

# should be your fork
set :repository, &quot;git@github.com:iridesco/pharm.git&quot;

set :deploy_to, &quot;/home/#{user}/#{application}&quot;
set :deploy_via, :remote_cache
set :scm, &#39;git&#39;
set :branch, &#39;origin/master&#39;
set :git_shallow_clone, 1
set :scm_verbose, true
set :use_sudo, false
set :keep_releases, &#39;10&#39;

server domain, :app, :web
role :db, domain, :primary =&gt; true

# =============================================================================
# Custom tasks
# =============================================================================

namespace :deploy do
    desc &quot;Tasks to complete after code update&quot;
  task :after_update_code do
    configs_for = %w{database admin options}
    commands_todo = configs_for.map do |cfg|
      &quot;ln -nfs #{deploy_to}/#{shared_dir}/config/#{cfg}.yml #{current_release}/config/#{cfg}.yml&quot;
    end
    commands_todo &lt;&lt; &quot;ln -nfs #{deploy_to}/#{shared_dir}/config/session.secret #{current_release}/config/session.secret&quot;
    commands_todo &lt;&lt; &quot;ln -nfs #{shared_path}/uploads #{release_path}/public/uploads&quot;
    run commands_todo.join(&quot; &amp;&amp; &quot;)
  end</code></pre>
</body>
</html>
