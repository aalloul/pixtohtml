<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>darkk_redsocks5</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p>root# iptables -t nat -A REDSOCKS -d 240.0.0.0/4 -j RETURN</p>
<h1 id="anything-else-should-be-redirected-to-port-12345">Anything else should be redirected to port 12345</h1>
<p>root# iptables -t nat -A REDSOCKS -p tcp -j REDIRECT –to-ports 12345</p>
<h1 id="any-tcp-connection-made-by-luser-should-be-redirected.">Any tcp connection made by `luser’ should be redirected.</h1>
<p>root# iptables -t nat -A OUTPUT -p tcp -m owner –uid-owner luser -j REDSOCKS</p>
<h1 id="you-can-also-control-that-in-more-precise-way-using-gid-owner-from">You can also control that in more precise way using <code>gid-owner</code> from</h1>
<h1 id="iptables.">iptables.</h1>
<p>root# groupadd socksified root# usermod –append –groups socksified luser root# iptables -t nat -A OUTPUT -p tcp -m owner –gid-owner socksified -j REDSOCKS</p>
<h1 id="now-you-can-launch-your-specific-application-with-gid-socksified-and-it">Now you can launch your specific application with GID <code>socksified</code> and it</h1>
<h1 id="will-be-socksified.-see-following-commands-numbers-may-vary.">will be… socksified. See following commands (numbers may vary).</h1>
<h1 id="note-you-may-have-to-relogin-to-apply-usermod-changes.">Note: you may have to relogin to apply <code>usermod</code> changes.</h1>
<p>luser$ id uid=1000(luser) gid=1000(luser) groups=1000(luser),1001(socksified) luser$ sg socksified -c id uid=1000(luser) gid=1001(socksified) groups=1000(luser),1001(socksified) luser$ sg socksified -c “firefox”</p>
<h1 id="if-you-want-to-configure-socksifying-router-you-should-look-at">If you want to configure socksifying router, you should look at</h1>
<h1 id="dociptables-packet-flow.png-dociptables-packet-flow-ng.png-and">doc/iptables-packet-flow.png, doc/iptables-packet-flow-ng.png and</h1>
<h1 id="httpsen.wikipedia.orgwikifilenetfilter-packet-flow.svg">https://en.wikipedia.org/wiki/File:Netfilter-packet-flow.svg</h1>
<h1 id="note-you-should-have-proper-local_ip-value-to-get-external-packets-with">Note, you should have proper `local_ip’ value to get external packets with</h1>
<h1 id="redsocks-default-127.0.0.1-will-not-go.-see-iptables8-manpage-regarding">redsocks, default 127.0.0.1 will not go. See iptables(8) manpage regarding</h1>
<h1 id="redirect-target-for-details.">REDIRECT target for details.</h1>
<h1 id="depending-on-your-network-configuration-iptables-conf.-may-be-as-easy-as">Depending on your network configuration iptables conf. may be as easy as:</h1>
<p>root# iptables -t nat -A PREROUTING –in-interface eth_int -p tcp -j REDSOCKS ```</p>
<h3 id="note-about-gid-based-redirection">Note about GID-based redirection</h3>
<p>Keep in mind, that changed GID affects filesystem permissions, so if your application creates some files, the files will be created with luser:socksified owner/group. So, if you’re not the only user in the group <code>socksified</code> and your umask allows to create group-readable files and your directory permissions, and so on, blah-blah, etc. THEN you may expose your files to another user. Ok, you have been warned.</p>
<h2 id="homepage">Homepage</h2>
<p>http://darkk.net.ru/redsocks/</p>
<p>Mailing list: <a href="mailto:redsocks@librelist.com">redsocks@librelist.com</a>.</p>
<p>Mailing list also has .</p>
</body>
</html>
