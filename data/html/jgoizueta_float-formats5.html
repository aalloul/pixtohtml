<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>jgoizueta_float-formats5</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="defining-new-formats">Defining new formats</h1>
<p>New formats are defined using one of the classes defined in float-formats/classes.rb and passing the necessary parameters in a hash to the constructor.</p>
<p>For example, here we define a binary floating point 32-bits format with 22 bits for the significand, 9 for the exponent and 1 for the sign (these fields are allocated from least to most significant bits). We’ll use excess notation with bias 127 for the exponent, interpreting the significand bits as a fractional number with the radix point after the first bit, which will be hidden:</p>
<pre><code>Flt.define(
  :MY_FP, BinaryFormat,
  fields: [:significand,22,:exponent,9,:sign,1],
  bias: 127, bias_mode: :scientific_significand,
  hidden_bit: true
)</code></pre>
<p>Now we can encode values in this format, decode values, convet to other formats, query it’s range, etc:</p>
<pre><code> puts MY_FP(&#39;0.1&#39;).to_bits_text(16)              # -&gt; 1ee66666
 puts MY_FP.max_value.to_text(Nio::Fmt.prec(3))  # -&gt; 7.88E115</code></pre>
<p>You can look at float-formats/formats.rb to see how the built-in formats are defined.</p>
<h1 id="license">License</h1>
<p>This code is free to use under the terms of the MIT license.</p>
<h1 id="references">References</h1>
<p>Description of formats used in UNIVAC 1100, CDC 6600/7600, PDP-11, IEEE754, IBM360/370</p>
<p>Description of formats used in VAX and PDF-11</p>
<h3 id="ieee754-binary-formats">IEEE754 binary formats</h3>
<h3 id="dpdieee754r-decimal-formats">DPD/IEEE754r decimal formats</h3>
</body>
</html>
