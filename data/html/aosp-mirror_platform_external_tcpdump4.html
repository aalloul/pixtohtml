<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>aosp-mirror_platform_external_tcpdump4</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<pre><code># 134 chunks.  536 packets sent.  508 acks.
1       1       0.00    5.80    0.20    0.20    4       1
2       513     0.28    6.20    0.40    0.40    4       1
3       1025    1.16    6.32    1.20    1.20    4       1
4       1561    1.86    15.00   2.00    2.00    6       1
5       2049    2.16    15.44   2.20    2.20    5       1
6       2585    2.64    16.44   2.80    2.80    5       1
7       3073    3.00    16.66   3.20    3.20    4       1
8       3609    3.20    17.24   3.40    5.82    4       11
9       4097    6.02    6.58    6.20    6.80    2       5

This says that 134 chunks were transferred (about 70K
since the average packet size was 512 bytes).  It took
536 packets to transfer the data (i.e., on the average
each chunk was transmitted four times).  Looking at,
say, chunk 4, we see it represents the 512 bytes of
sequence space from 1561 to 2048.  It was first sent
1.86 seconds into the conversation.  It was last
sent 15 seconds into the conversation and was sent
a total of 6 times (i.e., it was retransmitted every
2 seconds on the average).  It was acked once, 140ms
after it first arrived.</code></pre>
<p>stime.awk atime.awk Output one line per send or ack, respectively, in the form <time> &lt;seq. number&gt; where <time> is the time in seconds since the start of the transfer and &lt;seq. number&gt; is the sequence number being sent or acked. I typically plot this data looking for suspicious patterns.</p>
<p>The problem I was looking at was the bulk-data-transfer throughput of medium delay network paths (1-6 sec.Â round trip time) under typical DARPA Internet conditions. The trace of the ftp transfer of a large file was used as the raw data source. The method was:</p>
<ul>
<li><p>On a local host (but not the Sun running tcpdump), connect to the remote ftp.</p></li>
<li><p>On the monitor Sun, start the trace going. E.g., tcpdump host local-host and remote-host and port ftp-data &gt;tracefile</p></li>
<li><p>On local, do either a get or put of a large file (~500KB), preferably to the null device (to minimize effects like closing the receive window while waiting for a disk write).</p></li>
<li><p>When transfer is finished, stop tcpdump. Use awk to make up</p></li>
</ul>
</body>
</html>
