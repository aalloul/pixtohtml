<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>georgi_git_store1</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="git-store---using-git-as-versioned-data-store-in-ruby">Git Store - using Git as versioned data store in Ruby</h1>
<p>GitStore implements a versioned data store based on the revision management system [Git][1]. You can store object hierarchies as nested hashes, which will be mapped on the directory structure of a git repository. Basically GitStore checks out the repository into a in-memory representation, which can be modified and finally committed.</p>
<p>GitStore supports transactions, so that updates to the store either fail or succeed completely.</p>
<h3 id="installation">Installation</h3>
<p>GitStore can be installed as gem easily:</p>
<pre><code>$ gem sources -a http://gems.github.com
$ sudo gem install georgi-git_store</code></pre>
<h3 id="usage-example">Usage Example</h3>
<p>First thing you should do, is to initialize a new git repository.</p>
<pre><code>$ mkdir test
$ cd test
$ git init</code></pre>
<p>Now you can instantiate a GitStore instance and store some data. The data will be serialized depending on the file extension. So for YAML storage you can use the ‘yml’ extension:</p>
<pre><code>store = GitStore.new(&#39;/path/to/repo&#39;)

store[&#39;users/matthias.yml&#39;] = User.new(&#39;Matthias&#39;)
store[&#39;pages/home.yml&#39;] = Page.new(&#39;matthias&#39;, &#39;Home&#39;)

store.commit &#39;Added user and page&#39;</code></pre>
<h3 id="transactions">Transactions</h3>
<p>GitStore manages concurrent access by a file locking scheme. So only one process can start a transaction at one time. This is implemented by locking the <code>refs/head/&lt;branch&gt;.lock</code> file, which is also respected by the git binary.</p>
<p>If you access the repository from different processes or threads, you should write to the store using transactions. If something goes wrong inside a transaction, all changes will be rolled back to the original state.</p>
</body>
</html>
