<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>DianthuDia_double_submit_protection1</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="double-submit-protection-plugin">Double Submit Protection Plugin</h1>
<p>This plugin implements a symetrical token approach to avoid duplicate posts of data. This is specially useful when you’re dealing with data-sensitive forms (credit-card processing, for instance), where a duplicated posting may lead to a user getting charged twice. This control is done via a token placed on user’s form and synchronized with the session - whenever the token is different, you can simply verify it on the controllers by using the ‘double_submit?’ method</p>
<h1 id="usage-example">Usage Example</h1>
<h2 id="some_view.html.erb">some_view.html.erb</h2>
<pre><code>&lt;%= form_for :blah, :url =&gt; { :action =&gt; &quot;create&quot; } do |f| %&gt;
  ... (some form content here)
  &lt;%= double_submit_token %&gt;
&lt;% end %&gt;

&lt;%= form_for :foo, :url =&gt; { :action =&gt; &quot;create&quot; } do |f| %&gt;
  ... (some form content here)
  &lt;%= double_submit_token &#39;foo_submit_token&#39; %&gt;
&lt;% end %&gt;</code></pre>
<h2 id="blah_controller.rb">blah_controller.rb</h2>
<pre><code>def create
  if double_submit?
    flash[:message] = &#39;Whoa, hang in there dude...&#39;
    render :action =&gt; :register
    return
  end

  # do something here
end</code></pre>
<h2 id="foo_controller.rb">foo_controller.rb</h2>
<p>~~~ def create if double_submit? ‘foo_submit_token’ flash[:message] = ‘Whoa, hang in there dude…’ render :action =&gt; :register return end</p>
<p># do something here end</p>
</body>
</html>
