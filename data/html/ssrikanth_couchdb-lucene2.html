<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>ssrikanth_couchdb-lucene2</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p>The basic idea for indexing is that you specific a <code>_design/lucene</code> document that in turn specifies a set of views that will be indexed by couchdb-lucene. You can specify as many views for indexing as you desire.</p>
<p>Example <code>_design</code> document:</p>
<pre><code>{
    &quot;_id&quot;: &quot;_design/lucene&quot;,
    &quot;_rev&quot;: &quot;232924&quot;,
    &quot;views&quot;: {
        &quot;foo&quot;: {
            &quot;map&quot;: &quot;function(doc) {if(doc.foo) emit(doc._id, doc.foo);}&quot;
        },
        &quot;bar&quot;: {
            &quot;map&quot;: &quot;function(doc) {if(doc.bar) emit(doc._id, doc.bar);}&quot;
        }
    },
}</code></pre>
<p><strong>IMPORTANT</strong> You <strong>must</strong> <code>emit(doc._id, value_to_index)</code>. If you don’t emit a key that is the docid, nothing will get indexed.</p>
<h2 id="querying">Querying</h2>
<p>Parameters:</p>
<ol type="1">
<li><code>q</code>: A query string. This is processed by Lucene’s [QueryParser][parser]</li>
<li><code>limit</code>: Limit the number of results returned.</li>
<li><code>skip</code>: Skip over the first N results.</li>
</ol>
<p>Debug Parameters:</p>
<ol type="1">
<li><code>debug=true</code>: Wait until the indexing catches up to the database update_seq that was passed with this request. If -Xcouchdb.debug.enabled=“true” is specified on the command line, this defaults to true. If debug is not enabled, this parameter has no effect.</li>
<li><code>destroy=true</code>: Remove the entire database from the Lucene index. Only available when debug mode is enabled.</li>
</ol>
<p>Example URLs:</p>
<ul>
<li><code>http://127.0.0.1:5984/db_name/_fti?q=foo:query</code></li>
<li><code>http://127.0.0.1:5984/db_name/_fti?q=foo:plankton+bar:goat&amp;limit=1&amp;skip=1</code></li>
</ul>
<p>Example Results:</p>
<pre><code>{
    &quot;total_rows&quot;:2,
    &quot;offset&quot;: 0,
    &quot;rows&quot;: [
        {&quot;id&quot;:&quot;test&quot;,&quot;score&quot;:0.26010897755622864},
        {&quot;id&quot;:&quot;test2&quot;,&quot;score&quot;:0.2229505479335785}
    ]
}</code></pre>
<p>Feedback</p>
</body>
</html>
