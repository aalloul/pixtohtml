<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>jeremyevans_fixture_dependencies5</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p>You can load only the attributes of fixtures, without saving them with load_attributes. This is useful for occasions where you want to mutate attributes without having to create lots of fixtures or want to test code that is run before or after the database transaction (validations, model hooks).</p>
<pre><code># load_attributes responds like load, but without saving the record
fruit = load_attributes(:fruit__banana)
# test the behaviour before saving the record
fruit.save
# test the behaviour after saving the record</code></pre>
<p>You can also use the build method for loading the attributes of a single record, merging the attributes passed as options. This is useful for testing changes in behaviour when mutating a single parameter:</p>
<pre><code>old_banana   = build(:fruit__banana, :age=&gt;&#39;old&#39;)
fresh_banana = build(:fruit__banana, :age=&gt;&#39;new&#39;)
old_banana.must_be :rotten?
new_banana.wont_be :rotten?</code></pre>
<h2 id="one_to_manymany_to_manyhas_manyhas_and_belongs_to_many-assocations">one_to_many/many_to_many/has_many/has_and_belongs_to_many assocations</h2>
<p>Here’s an example of using has_one (logon_information), has_many (assets), and has_and_belongs_to_many (groups) associations.</p>
<pre><code>  jeremy:
  id: 2
  name: Jeremy Evans
  logon_information: jeremy
  assets: [asset1, asset2, asset3]
  groups: [group1]</code></pre>
<p><code>logon_information</code> is a has_one association to another table which was split from the employees table due to database security requirements. Assets is a has_many association, where one employee is responsible for the asset. Employees can be a member of multiple groups, and each group can have multiple employees.</p>
<p>For <code>has_*</code> associations, after fixture_dependencies saves jeremy, it will load and save logon_information (and its dependencies…), it will load each asset in the order specified (and their dependencies…), and it will load all of the groups in the order specified (and their dependencies…). Note that there</p>
</body>
</html>
