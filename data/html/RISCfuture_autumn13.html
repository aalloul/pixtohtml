<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>RISCfuture_autumn13</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p>if you have any Rails programming experience, you should be able to dive right in.</p>
<p>Once you’ve got DataMapper installed, you should create one or more database connections in your <code>config/seasons/[season]/database.yml</code> file. A sample database connection looks like:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="fu">connection_name:</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  <span class="fu">adapter:</span><span class="at"> mysql</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">  <span class="fu">host:</span><span class="at"> localhost</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  <span class="fu">username:</span><span class="at"> root</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  <span class="fu">password:</span><span class="at"> pass</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">  <span class="fu">database:</span><span class="at"> database_name</span></a></code></pre></div>
<p>or, in a smaller syntax:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="fu">connection_name:</span><span class="at"> </span><span class="st">&quot;mysql://root@pass:localhost/database_name&quot;</span></a></code></pre></div>
<p>If you are using the “sqlite3” adapter, the <code>path</code> option is the path to the file where the data should be written (example: <code>leaves/fortune/data/my_database.db</code>). Omit the <code>database</code> option.</p>
<p>You can name your connection however you want, but you <em>should</em> name it after either your leaf or your leaf subclass. (More on this below.)</p>
<p>You should also create DataMapper model classes for each of your model objects. You can place them within your leaf’s <code>models</code> directory. This works almost exactly the same as the app/models directory in Rails.</p>
<p>Once your database, data models, and leaves have been configured, you can use the <code>DB=[database config name] rake db:migrate</code> task to automatically populate your database.</p>
<p>Now, unlike Rails, Autumn supports multiple database connections. Two leaves can use two different database connections, or share the same database connection. Because of this, it’s important to understand how to manage your connections. Autumn tries to do this for you by guessing which connection belongs to which leaf, based on their names.</p>
<p>For example, imagine you have a leaf named “Fortune” and an instance of that leaf in <code>leaves.yml</code> named “MyFortune”. If you name your database connection either “Fortune” or “MyFortune” (or “fortune” or “my_fortune”), it will automatically be associated with that leaf. What this means is that for the leaf’s command methods (such as <code>about_command</code>) and invoked methods (such as <code>did_receive_private_message</code>), the database connection will already be set for you, and you can start using your DataMapper objects just like Active Record</p>
</body>
</html>
